@layer layout {
  .portfolio {
    --portfolio-item-spacing: var(--space-lg);
    display: flex;
    flex-direction: column;
    gap: var(--portfolio-item-spacing);
    width: calc(((100% - 10px) / 5) * 4);
  }

  .portfolio__hero {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
  }

  .portfolio__columns {
    width: 100%;
    display: grid;
    grid-template-columns: repeat(3, minmax(0, 1fr));
    gap: var(--space-md);
    align-items: flex-start;
  }

  .portfolio__column {
    display: flex;
    flex-direction: column;
    gap: var(--space-sm);
    min-height: 0;
  }

  .bigcard {
    /* Ensure cards don't cause layout shift and don't block scrolling */
    min-height: 200px;
    contain: layout style paint;
    /* Allow scrolling even if images are loading */
    will-change: auto;
  }

  .bigcard img {
    /* Ensure images don't block rendering - critical for mobile scroll */
    content-visibility: auto;
    contain-intrinsic-size: 800px 450px;
    /* Prevent images from blocking scroll */
    loading: lazy;
    decoding: async;
  }

  @media (max-width: 800px) {
    .bigcard {
      /* On mobile, ensure immediate scrollability */
      min-height: 150px;
    }
    
    .portfolio__columns {
      /* Ensure columns render immediately without waiting for all images */
      content-visibility: auto;
    }
  }

  .portfolio__columns .cards,
  .portfolio__columns .banner,
  .portfolio__columns .banner2,
  .portfolio__columns .portfolio-inline-block {
    width: 100%;
  }

  @media (max-width: 800px) {
    .portfolio {
      width: 100%;
    }

    .portfolio__columns {
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: var(--space-sm);
    }
  }
}
